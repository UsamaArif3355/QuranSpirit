name: "Produce New Tag"  
on: 
 push:
   branches:
     - main

jobs:
 build:
   runs-on: ubuntu-latest
   steps:
     - uses: actions/checkout@v2

     - name: Get Flutter version (Optional) 
       id: get_flutter_version       
       uses: its404/get-flutter-version@v1.0.0

     - name: Output Flutter version (Optional)
       run: echo 'version_number:' ${{ steps.get_flutter_version.outputs.version_number }} ' build_number:' ${{ steps.get_flutter_version.outputs.build_number }}

     - name: Get latest tag pushed
       id: tag
       uses: 32teeth/action-github-tag@v1
       with:
        # Return only the tag number (e.g., v1.0.0 -> 1.0.0)
        numbers_only: true
          
     - name: Use the latest tag pushed
       run: echo ${{steps.tag.outputs.tag}} 

     - name: Compare Versions and Create Tag (Modified)
       if: ${{ steps.get_flutter_version.outputs.version_number > steps.tag.outputs.tag }}  # Modified Condition
       run: |
         VERSION=${{ steps.get_flutter_version.outputs.version_number }} 
         git tag -a $VERSION -m "Automatic tag for version $VERSION"
         git push origin $VERSION
